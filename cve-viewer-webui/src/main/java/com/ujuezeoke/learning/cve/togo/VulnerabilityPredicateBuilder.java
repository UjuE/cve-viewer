package com.ujuezeoke.learning.cve.togo;

import com.ujuezeoke.learning.cve.model.CveVulnerability;

import java.util.Optional;
import java.util.function.Predicate;

/**
 * Created by ujuezeoke on 08/06/2016.
 */
public class VulnerabilityPredicateBuilder {

    private Integer year;

    public VulnerabilityPredicateBuilder withYear(Integer year) {
        this.year = year;
        return this;
    }

    public VulnerabilityPredicateBuilder withContains(String keywords) {
        throw new UnsupportedOperationException("Not Yet Implemented");
    }

    public VulnerabilityPredicate build() {
        return () -> {
            Predicate<CveVulnerability> defaultPredicate = cveVulnerability -> true;
            if(Optional.ofNullable(year)
                    .isPresent()){
                        defaultPredicate = defaultPredicate
                                .and(cveVulnerability -> cveVulnerability
                                        .getCveYear()
                                        .getValue()
                                        .equals(String.valueOf(year))
                                );
            }
            return defaultPredicate;
        };
    }
}
