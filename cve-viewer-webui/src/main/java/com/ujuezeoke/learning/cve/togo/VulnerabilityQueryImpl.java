package com.ujuezeoke.learning.cve.togo;

import com.ujuezeoke.learning.cve.CveFilesToList;
import com.ujuezeoke.learning.cve.model.CveVulnerability;

import java.io.File;
import java.util.List;
import java.util.stream.Collectors;

/**
 * Created by ujuezeoke on 09/06/2016.
 */
public class VulnerabilityQueryImpl implements VulnerabilityQuery {

    private final List<CveVulnerability> cveVulnerabilities;

    public VulnerabilityQueryImpl(File cveDirectory) {
        CveFilesToList cveFilesToList = new CveFilesToList(cveDirectory);
        cveVulnerabilities = cveFilesToList.getCveVulnerabilitiesMatching(cveVulnerability -> true);
    }

    @Override
    public List<CveVulnerability> findCveVulnerabilityMatching(VulnerabilityPredicate vulnerabilityPredicate) {
        return cveVulnerabilities.stream()
                .filter(vulnerabilityPredicate.build())
                .collect(Collectors.toList());
    }
}
