package com.ujuezeoke.learning.cve.model;

import java.util.List;

/**
 * Created by ujuezeoke on 29/11/2015.
 */
public class CveVulnerability {
    private final CveDocumentType documentType;
    private final CveDocumentVersion documentVersion;
    private final CveDocumentDateTime documentDateTime;
    private final List<CveNote> documentNotes;
    private final CveVulnerabilityTitle title;
    private final List<CveNote> cveNotes;
    private final List<CveVulnerabilityReference> references;

    public CveVulnerability(CveDocumentType documentType,
                            CveDocumentVersion documentVersion,
                            CveDocumentDateTime documentDateTime,
                            List<CveNote> documentNotes,
                            CveVulnerabilityTitle title,
                            List<CveNote> cveNotes,
                            List<CveVulnerabilityReference> references) {
        this.documentType = documentType;
        this.documentVersion = documentVersion;
        this.documentDateTime = documentDateTime;
        this.documentNotes = documentNotes;
        this.title = title;
        this.cveNotes = cveNotes;
        this.references = references;
    }

    public CveVulnerabilityTitle getTitle() {
        return title;
    }

    public List<CveNote> getVulnerabilityNotes() {
        return cveNotes;
    }

    public List<CveVulnerabilityReference> getReferences() {
        return references;
    }

    public CveDocumentType getDocumentType() {
        return documentType;
    }

    public List<CveNote> getDocumentNotes() {
        return documentNotes;
    }

    public CveDocumentVersion getDocumentVersion() {
        return documentVersion;
    }

    public CveDocumentDateTime getDocumentDateTime() {
        return documentDateTime;
    }

    public CveYear getCveYear(){
        return new CveYear(title);
    }

    @Override
    public boolean equals(Object o) {
        if (this == o) return true;
        if (o == null || getClass() != o.getClass()) return false;

        CveVulnerability that = (CveVulnerability) o;

        if (getDocumentType() != null ? !getDocumentType().equals(that.getDocumentType()) : that.getDocumentType() != null)
            return false;
        if (getDocumentVersion() != null ? !getDocumentVersion().equals(that.getDocumentVersion()) : that.getDocumentVersion() != null)
            return false;
        if (getDocumentDateTime() != null ? !getDocumentDateTime().equals(that.getDocumentDateTime()) : that.getDocumentDateTime() != null)
            return false;
        if (getDocumentNotes() != null ? !getDocumentNotes().equals(that.getDocumentNotes()) : that.getDocumentNotes() != null)
            return false;
        if (getTitle() != null ? !getTitle().equals(that.getTitle()) : that.getTitle() != null) return false;
        if (cveNotes != null ? !cveNotes.equals(that.cveNotes) : that.cveNotes != null) return false;
        return !(getReferences() != null ? !getReferences().equals(that.getReferences()) : that.getReferences() != null);

    }

    @Override
    public int hashCode() {
        int result = getDocumentType() != null ? getDocumentType().hashCode() : 0;
        result = 31 * result + (getDocumentVersion() != null ? getDocumentVersion().hashCode() : 0);
        result = 31 * result + (getDocumentDateTime() != null ? getDocumentDateTime().hashCode() : 0);
        result = 31 * result + (getDocumentNotes() != null ? getDocumentNotes().hashCode() : 0);
        result = 31 * result + (getTitle() != null ? getTitle().hashCode() : 0);
        result = 31 * result + (cveNotes != null ? cveNotes.hashCode() : 0);
        result = 31 * result + (getReferences() != null ? getReferences().hashCode() : 0);
        return result;
    }

    @Override
    public String toString() {
        return "CveVulnerability{" +
                "documentType=" + documentType +
                ", documentVersion=" + documentVersion +
                ", documentDateTime=" + documentDateTime +
                ", documentNotes=" + documentNotes +
                ", title=" + title +
                ", cveNotes=" + cveNotes +
                ", references=" + references +
                '}';
    }
}
