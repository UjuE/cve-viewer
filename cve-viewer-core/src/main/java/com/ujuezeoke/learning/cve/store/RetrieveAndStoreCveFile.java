package com.ujuezeoke.learning.cve.store;

import com.ujuezeoke.learning.cve.http.HttpRequestSender;
import org.apache.http.client.methods.HttpGet;

import java.util.logging.Level;
import java.util.logging.Logger;

import static com.ujuezeoke.learning.Loggers.coreLogger;
import static java.lang.String.format;

/**
 * Created by ujuezeoke on 29/11/2015.
 */
public class RetrieveAndStoreCveFile {
    private static final Logger LOGGER = coreLogger();
    private final HttpRequestSender httpRequestSender;
    private final DocumentStore documentStore;

    public RetrieveAndStoreCveFile(HttpRequestSender httpRequestSender,
                                   DocumentStore documentStore) {
        this.httpRequestSender = httpRequestSender;
        this.documentStore = documentStore;
    }

    public void retrieveAndStoreRemoteResource(String urlLocation) {
        LOGGER.log(Level.FINE, format("Retrieving from URL '%s'", urlLocation));
        HttpGet httpGet = new HttpGet(urlLocation);
        documentStore.store(null, httpRequestSender.execute(httpGet));
    }
}
