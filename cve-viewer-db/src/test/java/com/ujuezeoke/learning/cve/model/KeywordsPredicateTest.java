package com.ujuezeoke.learning.cve.model;

import org.junit.Test;

import java.util.Collections;
import java.util.List;

import static java.util.Arrays.asList;
import static org.hamcrest.core.Is.is;
import static org.junit.Assert.*;

/**
 * Created by ujuezeoke on 27/02/2016.
 */
public class KeywordsPredicateTest {

    @Test
    public void oneWordMatches() {
        KeywordsPredicate underTest = new KeywordsPredicate("java");

        assertThat(underTest.test(buildCveVulnerability("A string with only java")), is(true));
    }

    @Test
    public void comaSeparatedValues() {
        KeywordsPredicate underTest = new KeywordsPredicate("java,c++");

        assertThat(underTest.test(buildCveVulnerability("A string with only java")), is(true));
    }

    @Test
    public void colonSeparatedValues() {
        KeywordsPredicate underTest = new KeywordsPredicate("java;c++");

        assertThat(underTest.test(buildCveVulnerability("A string with only java")), is(true));
    }

    private CveVulnerability buildCveVulnerability(String stuff) {
        return new CveVulnerability(
                new CveDocumentType("whay"),
                new CveDocumentVersion("1223.322"),
                new CveDocumentDateTime("2015-11-27T06:01:46"),
                Collections.emptyList(),
                new CveVulnerabilityTitle("SomeTitle"),
                Collections.emptyList(),
                asList(new CveVulnerabilityReference(new ReferenceUrl("http://stuff"), new ReferenceDescription(stuff)),
                        new CveVulnerabilityReference(new ReferenceUrl("file://why.com"), new ReferenceDescription("Jump")))
        );
    }
}