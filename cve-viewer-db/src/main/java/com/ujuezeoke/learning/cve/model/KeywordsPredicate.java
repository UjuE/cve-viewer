package com.ujuezeoke.learning.cve.model;

import java.util.HashSet;
import java.util.List;
import java.util.Set;
import java.util.function.Predicate;

import static java.util.Arrays.asList;

/**
 * Created by ujuezeoke on 27/02/2016.
 */
public class KeywordsPredicate implements Predicate<CveVulnerability> {
    private static Set<String> DELIMITERS = new HashSet<>(asList(",", ";"));
    private List<String> keywords;

    public KeywordsPredicate(String keywords) {
        this(keywords.split(determineDelimiter(keywords)));
    }

    private static String determineDelimiter(String keywords) {
        return DELIMITERS.stream()
                .filter(keywords::contains)
                .findFirst()
                .orElse(",");
    }

    public KeywordsPredicate(String... keywords){
        this(asList(keywords));
    }

    public KeywordsPredicate(List<String> keywords) {
        this.keywords = keywords;
    }

    @Override
    public boolean test(CveVulnerability text) {
        return keywords
                .stream()
                .anyMatch(s -> text.toString().contains(s));
    }
}
